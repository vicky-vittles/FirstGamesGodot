[gd_scene load_steps=13 format=2]

[ext_resource path="res://entities/human/ai/_Brain.tscn" type="PackedScene" id=1]
[ext_resource path="res://systems/behavior_tree/Composites/sequencer.gd" type="Script" id=2]
[ext_resource path="res://entities/human/ai/actions/move_to_target.gd" type="Script" id=3]
[ext_resource path="res://entities/human/ai/actions/set_target.gd" type="Script" id=4]
[ext_resource path="res://systems/behavior_tree/Decorators/timed.gd" type="Script" id=5]
[ext_resource path="res://entities/human/ai/actions/calculate_path_to_target.gd" type="Script" id=6]
[ext_resource path="res://entities/human/ai/set_move_direction.gd" type="Script" id=7]
[ext_resource path="res://entities/human/ai/actions/find_nearest_hiding_spot.gd" type="Script" id=8]
[ext_resource path="res://entities/human/ai/conditions/is_in_state.gd" type="Script" id=9]
[ext_resource path="res://systems/behavior_tree/Decorators/succeeder.gd" type="Script" id=10]
[ext_resource path="res://systems/behavior_tree/Decorators/inverter.gd" type="Script" id=11]
[ext_resource path="res://entities/human/ai/actions/set_inputs.gd" type="Script" id=12]

[node name="Brain" instance=ExtResource( 1 )]

[node name="root" type="Node" parent="." index="0"]
script = ExtResource( 2 )

[node name="go to hide spot" type="Node" parent="root" index="0"]
script = ExtResource( 2 )

[node name="timed update on hiding spot pos" type="Node" parent="root/go to hide spot" index="0"]
script = ExtResource( 5 )
period = 0.2

[node name="get path to hiding spot" type="Node" parent="root/go to hide spot/timed update on hiding spot pos" index="0"]
script = ExtResource( 2 )

[node name="find nearest hiding spot" type="Node" parent="root/go to hide spot/timed update on hiding spot pos/get path to hiding spot" index="0"]
script = ExtResource( 8 )

[node name="set target" type="Node" parent="root/go to hide spot/timed update on hiding spot pos/get path to hiding spot" index="1"]
script = ExtResource( 4 )
param_name = "nearest_hiding_spot"

[node name="calculate path to target" type="Node" parent="root/go to hide spot/timed update on hiding spot pos/get path to hiding spot" index="2"]
script = ExtResource( 6 )

[node name="move to hiding spot" type="Node" parent="root/go to hide spot" index="1"]
script = ExtResource( 3 )

[node name="crouch and stay invisible" type="Node" parent="root" index="1"]
script = ExtResource( 2 )

[node name="crouch" type="Node" parent="root/crouch and stay invisible" index="0"]
script = ExtResource( 10 )

[node name="sequencer" type="Node" parent="root/crouch and stay invisible/crouch" index="0"]
script = ExtResource( 2 )

[node name="if not crouching" type="Node" parent="root/crouch and stay invisible/crouch/sequencer" index="0"]
script = ExtResource( 11 )

[node name="check if in crouch state" type="Node" parent="root/crouch and stay invisible/crouch/sequencer/if not crouching" index="0"]
script = ExtResource( 9 )
state = "Crouch"

[node name="press crouch" type="Node" parent="root/crouch and stay invisible/crouch/sequencer" index="1"]
script = ExtResource( 12 )
buttons_to_press = [ "crouch" ]
press_types = [ 2 ]
values = [ true ]

[node name="stay still" type="Node" parent="root/crouch and stay invisible" index="1"]
script = ExtResource( 7 )
